<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <script src="assets/js/fullcalendar/moment.min.js"></script>
    <link rel="stylesheet" type="text/css" href="assets/css/core.css">
    <link rel="stylesheet" type="text/css" href="../../../resources/css/core.css">
    <link rel="stylesheet" type="text/css" href="../../resources/css/bootstrap-clearmin.min.css">
    <script src="https://unpkg.com/canvas-datagrid/dist/canvas-datagrid.js"></script>

    <script src="assets/js/jquery/jquery.min.js"></script>
    <script src="../../resources/js/jquery.min.js"></script>
    <script src="../js/jquery/jquery.min.js"></script>
    <script src="jquery.min.js"></script>
    <title>LetzteChance.Org default plugin</title>
    <style>
        #htmlout {
            height: auto;
            min-height: 10px;
            min-width: 96%;
        }
        
        #drop {
            border: 2px dashed #bbb;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            border-radius: 5px;
            padding: 25px;
            text-align: center;
            font: 16pt bold, "Arial";
            color: #bbb
        }
        
        a {
            text-decoration: none
        }
        
        .fl {
            float: left;
        }
    </style>
</head>

<body>
    <h4>Core Plugin Menu</h4>
    <ul id="myTab" class="nav nav-tabs" role="tablist">

        <li role="presentation" class="active">
            <a href="#home" id="home-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">Core Plugin</a>
        </li>

        <li role="presentation" class="active">
            <a href="#cli" id="cli-tab" role="tab" data-toggle="tab" aria-controls="cli" aria-expanded="true">CLI</a>
        </li>
        <li role="presentation" class="">
            <a href="#importcsv" role="tab" id="importcsv-tab" data-toggle="tab" aria-controls="importcsv" aria-expanded="false">Import CSV</a></li>

        <li role="presentation" class="">
            <a href="#exportdb" role="tab" id="exportdb-tab" data-toggle="tab" aria-controls="exportdb" aria-expanded="false">Export Database</a></li>

        <li role="presentation" class="">
            <a href="#readcsv" role="tab" id="readcsv-tab" data-toggle="tab" aria-controls="readcsv" aria-expanded="false">Read CSV</a></li>

        <li role="presentation" class="dropdown">
            <a href="#" id="myTabDrop1" class="dropdown-toggle" data-toggle="dropdown" aria-controls="myTabDrop1-contents" aria-expanded="false">API <span class="caret"></span></a>
            <ul class="dropdown-menu" role="menu" aria-labelledby="myTabDrop1" id="myTabDrop1-contents">
                <li><a href="#dropdown1" tabindex="-1" role="tab" id="dropdown1-tab" data-toggle="tab" aria-controls="dropdown1">@coming soon</a></li>
                <li><a href="#dropdown2" tabindex="-1" role="tab" id="dropdown2-tab" data-toggle="tab" aria-controls="dropdown2">@update coming soon.</a></li>
            </ul>
        </li>
    </ul>
    <br>
    <div id="myTabContent" class="tab-content">

        <div role="tabpanel" class="tab-pane fade active in" id="home" aria-labelledby="home-tab">
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call exec .\\resources\\plugins\\core.bat .\\resources\\plugins\\core.menu.csv', 'cnt');">Reload</button>
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\exec.sqlite.bat .dump>schema.sql', 'core_cnt');">Dump Schema</button>
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call type .\\schema.sql', 'core_cnt');">Show Schema</button>
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call type .\\schema.sql', 'core_cnt');">Show Database</button>
            <!-- <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call help.bat', 'config_cnt');">Help</button> -->

        </div>

        <div role="tabpanel" class="tab-pane fade" id="cli" aria-labelledby="cli-tab">
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\showconfig.bat', 'config_cnt');">Reload</button>
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call help.bat', 'config_cnt');">Help</button>
            <form>
                <label>CLI:</label>
                <input id="scanpattern" type="text" value=".\*.csv"></input>
                <input id="btnSubmit" type="button" value="Submit" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\sdir.bat '+$('#scanpattern').val(), 'cli_cnt');"></input>
            </form>
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\showtemp.bat', 'cli_cnt');">Show temp</button>
            <div id="cli_cnt" style="min-width:100%;width:100%;"></div>
        </div>

        <div role="tabpanel" class="tab-pane fade" id="importcsv" aria-labelledby="importcsv-tab">
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\showconfig.bat', 'appcnt');">Reload</button>
            <form>
                <label>Import Suchbegriff:</label>
                <input id="importpattern" type="text" value="test.csv"></input>
                <label>Tabelle:</label>
                <input id="importtable" type="text" value="appgames"></input>
                <input id="btnSubmit" type="button" value="Submit" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\import.from.csv.to.sqlite.bat '+$('#importpattern').val()+' '+$('#importtable').val(), 'config_cnt');"></input>
            </form>
        </div>

        <div role="tabpanel" class="tab-pane fade" id="exportdb" aria-labelledby="exportdb-tab">
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\exportdb.bat', 'config_cnt');">Export</button>
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\exec.sqlite.bat .dump>schema.sql', 'core_cnt');">Dump Schema</button>
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call type .\\schema.sql', 'core_cnt');">Show Schema</button>
        </div>


        <div role="tabpanel" class="tab-pane fade" id="readcsv" aria-labelledby="readcsv-tab">
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call exec .\\resources\\cmd\\showconfig.bat', 'appcnt');">Reload</button>
            <form>
                <label>Read Suchbegriff:</label>
                <input id="scanpattern" type="text" value="test.csv"></input>
                <label>Tabelle:</label>
                <input id="scantable" type="text" value="appgames"></input>
                <input id="btnSubmit" type="button" value="Submit" onclick="new HttpRequest().execCMD('call .\\resources\\cmd\\import.from.csv.to.sqlite.bat '+$('#scanpattern').val()+' '+$('#scantable').val(), 'config_cnt');"></input>
            </form>
        </div>

        <div role="tabpanel" class="tab-pane fade" id="dropdown1" aria-labelledby="dropdown1-tab">
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call exec .\\resources\\cmd\\showconfig.bat', 'appcnt');">Reload</button>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="dropdown2" aria-labelledby="dropdown2-tab">
            <button type="button" class="btn btn-default" onclick="new HttpRequest().execCMD('call exec .\\resources\\cmd\\showconfig.bat', 'appcnt');">Reload</button>
        </div>
    </div>
    <hr>
    <div id="config_cnt"></div>
    <script>
        console.log('Running..');
        jQuery('#plugins').append('<hr>Welcome');
        $('#other').append('<hr>Welcome');
        console.log('Done.');

        function parseUrl() {
            var pattern = document.getElementById('pattern').value;
            if (pattern != undefined && pattern.length > 0) {
                //alert('Searching:'+pattern);
                print('Searching:' + pattern, 'outcnt');
            } else {
                alert('Search pattern is empty. Please enter a value');
                return
            }
            execCMD('call exec.bat .\\resources\\plugins\\lc2extracturls_x64.exe.bat ' + pattern, 'outcnt')

        }

        function print(text, id) {
            document.getElementById(id).innerHTML = text;
            console.log(text);
        }

        function execCMD(text, id) {
            console.log('execCMD running...');
            print("<h1>STUNNING</h1>", id);
            const {
                exec
            } = require('child_process');
            //document.getElementById("error").innerHTML = "";
            print("", "error");
            print("<div class=\"preload\"></div>", id);
            // alert('OUT:'+text.length);
            try {


                exec('' + text, (err, stdout, stderr) => {

                    if (err) {
                        console.error(err);
                        print("" + JSON.stringify(err), "error");
                        print("" + stdout, id);
                        //document.getElementById(id).innerHTML = stdout;
                        return;
                    }
                    //document.getElementById(id).innerHTML = stdout;
                    print("" + stdout, id);
                    console.log('execCMD done.');
                });
            } catch (error) {
                print("" + JSON.stringify(err), "error");
                console.error(JSON.stringify(err))


            }
        }
        //
    </script>
</body>

</html>